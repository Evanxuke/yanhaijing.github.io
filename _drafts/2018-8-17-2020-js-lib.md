---
layout: post
title: 2018年如何写一个现代的JavaScript库
category : javascript
tagline: "原创"
tags : [javascript]
keywords: [javascript]
description: 
---
{% include JB/setup %}

我写过一些[开源项目](https://github.com/yanhaijing)，在开源方面有一些经验，最近开到了阮老师的微博，深有感触，现在一个开源项目涉及的东西确实挺多的，特别是对于新手来说非常不友好

![]({{BLOG_IMG}}529.png)

最近我写了一个[jslib-base](https://github.com/yanhaijing/jslib-base)，旨在从多方面快速帮大家搭建一个标准的js库，本文将已jslib-base为例，介绍写一个开源库的知识

> jslib-base 最好用的js第三方库脚手架，赋能js第三方库开源，让开发一个js库更简单，更专业

## 文档
所谓代码未动，文档先行，文档对于一个项目非常重要，一个项目的文档包括

- README.md
- TODO.md
- CHANGELOG.md
- LICENSE
- doc

### README.md
README是一个项目的门面，应该简单明了的呈现用户最关心的问题，一个开源库的用户包括使用者和贡献者，所以一个文档应该包括项目简介，使用者指南，贡献者指南三部分

项目简介用该简单介绍项目功能，使用场景，兼容性的相关知识，这里重点介绍下徽章，相信大家都见过别人项目中的徽章，如下所示

![]({{BLOG_IMG}}530.png)

徽章通过更直观的方式，将更多的信息呈现出来，还能够提高颜值，有一个网站专门制作各种徽章，可以看[这里](https://shields.io/#/)

这里有一个README的[完整的例子](https://github.com/yanhaijing/jslib-base/blob/master/README.md)

### TODO.md
TODO应该记录项目的未来计划，这对于贡献者和使用者都有很重要的意义，下面是TODO的例子

```
- [X] 已完成
- [ ] 未完成
```

### CHANGELOG.md
CHANGELOG记录项目的变更日志，对项目使用者非常重要，特别是在升级使用版本时，CHANGELOG需要记录项目的版本，发版时间和版本变更记录

```
## 0.1.0 / 2018-10-6

- 新增xxx功能
- 删除xxx功能
- 更改xxx功能
```

### LICENSE
开源项目必须要选择一个协议，因为没有协议的项目是没有人敢使用的，关于不同协议的区别可以看下面这张图（出自阮老师博客），我的建议是选择MIT或者BSD协议

![]({{BLOG_IMG}}531.png)

### doc
开源项目还应该提供详细的使用文档，一份详细文档的每个函数介绍都应该包括如下信息：

```
函数简单介绍

函数详细介绍

函数参数和返回值（要遵守下面的例子的规则）

- param {string} name1 name1描述
- return {string} 返回值描述

举个例子（要包含代码用例）

// 代码

特殊说明，比如特殊情况下会报错等
```
## 构建

## 代码规范
代码风格我们通过eslint来保证，关于eslint的安装和配置这里不再展开解释了，在jslib-base中只需要运行下面的命令就可以进行代码校验了，eslint的配置文件位于`config/.eslintrc.js`

```bash
$ npm run lint
```

eslint只能够保证代码规范，却不能保证提供优秀的接口设计，关于函数接口设计有一些指导规则

参数数量

- 函数的参数个数最多不要超过5个

可选参数

- 可选参数应该放到后面
- 可选参数数量超过三个时，可以使用对象传入
- 可选参数，应该提供默认值

参数校验与类型转换

- 必传参数，如果不传要报错
- 对下列类型要做强制检验，类型不对要报错（object, array, function）
- 对下列类型要做自动转换（number, string, boolean）
- 对于复合类型的内部数据，也要做上面的两个步骤
- 对于number转换后如果为NaN，要做特殊处理（有默认值的赋值为默认值，无默认值的要报错）

参数类型

- 参数尽量使用值类型（简单类型）
- 参数尽量不要使用复杂类型（避免副作用）
- 使用复杂类型时，层级不要过深
- 使用复杂数据类型时，应该进行深拷贝（避免副作用）

函数返回值

- 返回值可返回操作结果（获取接口），操作是否成功（保存接口）
- 返回值的类型要保持一致

- 返回值尽量使用值类型（简单类型）
- 返回值尽量不要使用复杂类型（避免副作用）

## 测试

## 可持续集成

## 其他内容

## jsmini

## 总结
